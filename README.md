See code for more description.

An example spreadsheet that can run this.
![Screenshot from 2025-03-28 11-27-44](https://github.com/user-attachments/assets/5cad3100-e2ed-4781-b17b-f5af57c51dba)

An example chart you can expect.
![image](https://github.com/user-attachments/assets/ec90bc60-f17c-4c14-8e71-9776db60a9d6)
